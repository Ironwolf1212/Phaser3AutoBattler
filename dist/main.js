(()=>{"use strict";const t=Phaser.Structs.Set;class e extends Phaser.Plugins.BasePlugin{constructor(t){super(t)}start(){this.game.events.on("destroy",this.destroy,this)}add(e,s){return new class{constructor(e,s){this.setCompleteCallback(e,s),this.events=new t}shutdown(){return this.setCompleteCallback(void 0,void 0),this.events.clear(),this.event=void 0,this}destroy(){return this.shutdown(),this}setCompleteCallback(t,e){return this.completeCallback=t,this.scope=e,this}waitCallback(){var t=this,e=function(){t.remove(e)};return this.events.set(e),e}waitEvent(t,e){return t.once(e,this.waitCallback()),this}remove(t){return this.events.delete(t),this.noWaitEvent&&(this.scope?this.completeCallback.call(this.scope):this.completeCallback()),this}clear(){return this.events.clear(),this}get noWaitEvent(){return 0===this.events.size}}(e,s)}}const s=e;var a,i,r,n,l={type:Phaser.AUTO,width:800,height:600,physics:{default:"arcade",arcade:{gravity:{y:300},debug:!1}},plugins:{global:[{key:"rexWaitEvents",plugin:s,start:!0}]},scene:{preload:function(){this.load.audio("hitSound",["assets/Hit_Thump.mp3"]),this.load.image("sky","assets/sky.png"),this.load.image("ground","assets/platform.png"),this.load.image("star","assets/star.png"),this.load.image("bomb","assets/bomb.png"),this.load.spritesheet("dude","assets/dude.png",{frameWidth:32,frameHeight:48})},create:function(){this.input.keyboard.createCursorKeys(),this.add.image(400,300,"sky"),(a=this.physics.add.staticGroup()).create(400,568,"ground").setScale(2).refreshBody(),i=this.physics.add.sprite(100,350,"dude"),n=this.physics.add.sprite(670,350,"dude"),i.setCollideWorldBounds(!0),n.setCollideWorldBounds(!0),r=this.add.text(16,16,"Turn: "+o+"("+d+")",{fontSize:"32px",fill:"#000"}),this.anims.create({key:"left",frames:this.anims.generateFrameNumbers("dude",{start:0,end:3}),frameRate:10,repeat:-1}),this.anims.create({key:"turn",frames:[{key:"dude",frame:4}],frameRate:20}),this.anims.create({key:"right",frames:this.anims.generateFrameNumbers("dude",{start:5,end:8}),frameRate:10,repeat:-1}),this.physics.add.collider(i,a),this.physics.add.collider(n,a),this.physics.add.overlap(i,n,f,null,this),i.anims.play("turn",!0),n.anims.play("turn",!0)},update:function(){var t;d+=1,r.setText("Turn: "+o+"("+d+")"),d>=200&&("left"==o?(t=m.length,p=Math.floor(Math.random()*t),v(m[p],y=1),i.anims.play("right",!0)):(n.setVelocityX(-250),n.anims.play("left",!0))),1==c&&("left"==o?(i.anims.play("left",!0),i.setVelocityX(-250),i.x<100&&(i.setVelocityX(0),i.setPosition(100,513),c=!1,u=!0),d=0,u&&(i.anims.play("turn",!0),o="right")):(n.anims.play("right",!0),n.setVelocityX(250),n.x>670&&(n.setVelocityX(0),n.setPosition(670,513),c=!1,u=!0),d=0,u&&(n.anims.play("turn",!0),o="left"))),h.time.now-g>m[p][y][2]&&y<m[p].length&&(y++,v(m[p],y))}}},h=new Phaser.Game(l),d=0,o="left",c=!1,u=!1,m=[["regularHit",["2",2500,0]],["jumpAttack",["2",2500,100]],["chargedAttack",["2",2500,1e3]]],p=-1,y=0,g=0;function f(){var t=this.sound.add("hitSound"),e=this.plugins.get("rexWaitEvents").add((function(){i.clearTint(),n.clearTint()}));u=!1,t.play(),"left"==o?(n.setTint(16711680),this.time.delayedCall(60,e.waitCallback())):(i.setTint(16711680),this.time.delayedCall(60,e.waitCallback())),i.setVelocityX(0),n.setVelocityX(0),c=!0}function v(t,e){switch(t[e][0]){case"1":break;case"2":i.setVelocityX(m[p][e][1])}g=h.time.now}})();